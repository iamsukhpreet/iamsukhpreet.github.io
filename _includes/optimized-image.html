{% comment %}
  Optimized image include with lazy loading and WebP support
  Usage: {% include optimized-image.html src="/path/to/image.jpg" alt="Description" %}
{% endcomment %}

<picture>
  <source 
    data-srcset="{{ include.src | replace: '.jpg', '.webp' | replace: '.png', '.webp' | absolute_url }}"
    type="image/webp"
    class="lazy"
  >
  <img 
    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
    data-src="{{ include.src | absolute_url }}"
    alt="{{ include.alt | default: 'Image' }}"
    class="lazy optimized-image"
    loading="lazy"
    width="{{ include.width | default: 'auto' }}"
    height="{{ include.height | default: 'auto' }}"
    {% if include.caption %}
    title="{{ include.caption }}"
    {% endif %}
    onload="this.classList.add('loaded')"
  >
</picture>
